<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Секретная страница</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <!--comm <script src="script.js"></script -->
	
</head>
<body>
    <!--Start-->
    U2FsdGVkX1/t5nAd4Jt5wF8DlegZvYWIEgk3xH7HLMRUUx2MWngqe5cZExB9eZpHoePWwA3fUn1WpYZb61S4YjZk8shXibAgrS/mUP9a68kDiQ2f2auERiNRrHqHIb+wc7cuoniQAxYDWo4f8S4XviRG8Zosa0yK8wRADbcN+guQFXE32p+7GMf19mMiAmPdUnC+GBW6JyQBHTXmGsQlbQ/B8IfsOfgqJc6xOAD5W9c=
    <!--END-->
    <div id="accelerometerOutput"></div>
    <div id="gyroscopeOutput"></div>
    <div id="numOutput"></div>
	<script>
function detectBrowserAndOS() {
  const userAgent = navigator.userAgent;
  let browserInfo = "Неизвестный браузер";
  let osInfo = "Неизвестная ОС";

  if (/Safari/.test(userAgent) && !/Chrome/.test(userAgent)) {
    browserInfo = "Safari";
  } else if (/Firefox/.test(userAgent)) {
    browserInfo = "Firefox";
  } else if (/Chrome/.test(userAgent)) {
    browserInfo = "Chrome";
  } else if (/Edge/.test(userAgent)) {
    browserInfo = "Edge";
  }

  if (/Win/.test(userAgent)) {
    osInfo = "Windows";
  } else if (/Mac/.test(userAgent)) {
    osInfo = "macOS";
  } else if (/iPhone|iPad|iPod/.test(userAgent)) {
    osInfo = "iOS";
  } else if (/Android/.test(userAgent)) {
    osInfo = "Android";
  } else if (/Linux/.test(userAgent)) {
    osInfo = "Linux";
  }

  return { browser: browserInfo, os: osInfo };
}

function detectOSByVoices() {
  const voices = speechSynthesis.getVoices();
  const { browser, os } = detectBrowserAndOS();

  if (browser === "Safari" || (voices.length === 0 && /^(Mac|iPhone|iPad|iPod)/.test(os))) {
    return `${os} (вероятно Safari или другой WebKit браузер)`;
  }

  const hasEnglish = voices.some(voice => voice.lang.startsWith('en'));
  const hasRussian = voices.some(voice => voice.lang.startsWith('ru'));
  const googleVoices = voices.filter(voice => voice.name.includes('Google'));
  const microsoftVoices = voices.filter(voice => voice.name.includes('Microsoft'));
  const appleVoices = voices.filter(voice => voice.name.includes('Samantha') || voice.name.includes('Alex'));
  const androidVoices = voices.filter(voice => voice.name.includes('Samsung') || voice.name.includes('LG'));

  if (microsoftVoices.length > 0) {
    return "Windows (99% вероятность)";
  } else if (googleVoices.length > 0 && microsoftVoices.length > 0) {
    return "Windows с установленным Chrome";
  } else if (appleVoices.length > 0) {
    return "iOS/macOS";
  } else if (androidVoices.length > 0) {
    return "Android";
  } else if (googleVoices.length > 0) {
    return "Chrome OS или Android";
  } else if (hasEnglish && !hasRussian && appleVoices.length === 0) {
    return "Возможно Linux";
  } else {
    return `Не удалось точно определить ОС. Предполагаемые ОС: ${os}, Браузер: ${browser}`;
  }
}

let voicesChangedHandled = false;

function populateVoiceListAndDetectOS() {
  if (typeof speechSynthesis === 'undefined') {
    console.log("Speech synthesis не поддерживается в этом браузере.");
    return;
  }

  const voices = speechSynthesis.getVoices();

  if (voices.length > 0 || voicesChangedHandled) {
    const numOutput = document.getElementById('numOutput');
    numOutput.innerHTML = ''; 

    voices.forEach(voice => {
      const voiceDiv = document.createElement('div');
      voiceDiv.textContent = `${voice.name} (${voice.lang})`;
      numOutput.appendChild(voiceDiv);
    });

    const result = detectOSByVoices();
    numOutput.innerHTML = ("Операционная система и браузер: "+ result);
    
  } else {
    voicesChangedHandled = true;
    speechSynthesis.onvoiceschanged = function () {
      populateVoiceListAndDetectOS();
    };
  }
}

populateVoiceListAndDetectOS();
</script>

</body>

</html>
